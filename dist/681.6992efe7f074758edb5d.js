(self.webpackChunke_commerce_mosh=self.webpackChunke_commerce_mosh||[]).push([[681],{16681:(e,t,n)=>{"use strict";n.r(t),n.d(t,{OrdersModule:()=>J});var r=n(61116),a=n(31041),l=n(87791),i=n(81830),d=n(66262),o=n(99484),s=n(90317),m=n(29996),p=n(20868),c=n(23651),u=n(63995),h=n(3050),g=n(35366),v=n(42590),f=n(27455),y=n(87064),x=n(84369),S=n(54670),E=n(13070),C=n(69024),I=n(47217),O=n(6489);function b(e,t){if(1&e&&(g["\u0275\u0275elementStart"](0,"div",34),g["\u0275\u0275elementStart"](1,"div"),g["\u0275\u0275text"](2,"PEDIDOS RECIENTES SIN APROBAR: \xa0\xa0\xa0\xa0 "),g["\u0275\u0275element"](3,"span",35),g["\u0275\u0275text"](4,"\xa0\xa0\xa0\xa0 "),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"]()),2&e){const e=g["\u0275\u0275nextContext"](2);g["\u0275\u0275advance"](3),g["\u0275\u0275propertyInterpolate"]("matBadge",e.ordersNotAproved)}}function w(e,t){if(1&e){const e=g["\u0275\u0275getCurrentView"]();g["\u0275\u0275elementStart"](0,"tr"),g["\u0275\u0275elementStart"](1,"td"),g["\u0275\u0275text"](2),g["\u0275\u0275pipe"](3,"date"),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](4,"td"),g["\u0275\u0275elementStart"](5,"a",37),g["\u0275\u0275listener"]("click",function(){const t=g["\u0275\u0275restoreView"](e).$implicit;return g["\u0275\u0275nextContext"](3).toggleAccordion(t)}),g["\u0275\u0275text"](6),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](7,"td"),g["\u0275\u0275text"](8),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit;g["\u0275\u0275advance"](2),g["\u0275\u0275textInterpolate1"]("",g["\u0275\u0275pipeBind2"](3,3,e.date,"dd/MM/yyyy HH:mm"),"\xa0\xa0"),g["\u0275\u0275advance"](4),g["\u0275\u0275textInterpolate1"]("",e.fantasyName,"\xa0\xa0\xa0\xa0"),g["\u0275\u0275advance"](2),g["\u0275\u0275textInterpolate"](e.seller)}}function D(e,t){if(1&e&&(g["\u0275\u0275elementStart"](0,"div",3),g["\u0275\u0275elementStart"](1,"mat-accordion"),g["\u0275\u0275elementStart"](2,"mat-expansion-panel",36),g["\u0275\u0275elementStart"](3,"mat-expansion-panel-header"),g["\u0275\u0275elementStart"](4,"mat-panel-title"),g["\u0275\u0275text"](5," Detalle "),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](6,"table",30),g["\u0275\u0275elementStart"](7,"thead"),g["\u0275\u0275elementStart"](8,"tr"),g["\u0275\u0275elementStart"](9,"th"),g["\u0275\u0275text"](10,"Fecha"),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](11,"th"),g["\u0275\u0275text"](12,"Cliente"),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](13,"th"),g["\u0275\u0275text"](14,"Vendedor"),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](15,"tbody"),g["\u0275\u0275template"](16,w,9,6,"tr",31),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"]()),2&e){const e=g["\u0275\u0275nextContext"](2);g["\u0275\u0275advance"](16),g["\u0275\u0275property"]("ngForOf",e.notAprovedOrders)}}function N(e,t){1&e&&(g["\u0275\u0275elementStart"](0,"mat-error"),g["\u0275\u0275text"](1,"Invalid start date"),g["\u0275\u0275elementEnd"]())}function V(e,t){1&e&&(g["\u0275\u0275elementStart"](0,"mat-error"),g["\u0275\u0275text"](1,"Invalid end date"),g["\u0275\u0275elementEnd"]())}function A(e,t){1&e&&(g["\u0275\u0275elementStart"](0,"th"),g["\u0275\u0275text"](1,"Fecha"),g["\u0275\u0275elementEnd"]())}function M(e,t){1&e&&(g["\u0275\u0275elementStart"](0,"th"),g["\u0275\u0275text"](1,"Monto c/IVA"),g["\u0275\u0275elementEnd"]())}function k(e,t){1&e&&(g["\u0275\u0275elementStart"](0,"th"),g["\u0275\u0275text"](1,"\xbfaprobado?"),g["\u0275\u0275elementEnd"]())}function q(e,t){1&e&&(g["\u0275\u0275elementStart"](0,"th"),g["\u0275\u0275text"](1,"IVA"),g["\u0275\u0275elementEnd"]())}function F(e,t){1&e&&(g["\u0275\u0275elementStart"](0,"th"),g["\u0275\u0275text"](1,"Pagado"),g["\u0275\u0275elementEnd"]())}function P(e,t){1&e&&(g["\u0275\u0275elementStart"](0,"th"),g["\u0275\u0275text"](1,"Desc?"),g["\u0275\u0275elementEnd"]())}function T(e,t){1&e&&(g["\u0275\u0275elementStart"](0,"th"),g["\u0275\u0275text"](1,"Deudor?"),g["\u0275\u0275elementEnd"]())}function U(e,t){if(1&e){const e=g["\u0275\u0275getCurrentView"]();g["\u0275\u0275elementStart"](0,"button",41),g["\u0275\u0275listener"]("click",function(){g["\u0275\u0275restoreView"](e);const t=g["\u0275\u0275nextContext"]().$implicit;return g["\u0275\u0275nextContext"](2).aprove(t)}),g["\u0275\u0275text"](1,"aprobar"),g["\u0275\u0275elementEnd"]()}if(2&e){const e=g["\u0275\u0275nextContext"]().$implicit;g["\u0275\u0275property"]("disabled",e.payload.val().aproved)}}function z(e,t){if(1&e&&(g["\u0275\u0275elementStart"](0,"tr"),g["\u0275\u0275elementStart"](1,"td"),g["\u0275\u0275text"](2),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](3,"td"),g["\u0275\u0275text"](4),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](5,"td"),g["\u0275\u0275text"](6),g["\u0275\u0275pipe"](7,"number"),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](8,"td"),g["\u0275\u0275text"](9),g["\u0275\u0275pipe"](10,"number"),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](11,"td"),g["\u0275\u0275text"](12),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;g["\u0275\u0275advance"](2),g["\u0275\u0275textInterpolate"](e.quantity),g["\u0275\u0275advance"](2),g["\u0275\u0275textInterpolate"](e.title),g["\u0275\u0275advance"](2),g["\u0275\u0275textInterpolate1"]("$",g["\u0275\u0275pipeBind2"](7,5,e.discountPrice,"1.1-1"),""),g["\u0275\u0275advance"](3),g["\u0275\u0275textInterpolate1"]("$",g["\u0275\u0275pipeBind2"](10,8,e.quantity*e.discountPrice,"1.1-1"),"\xa0\xa0"),g["\u0275\u0275advance"](3),g["\u0275\u0275textInterpolate"](e.discount?"%"+e.discount:"-")}}function L(e,t){if(1&e&&(g["\u0275\u0275elementStart"](0,"table",30),g["\u0275\u0275elementStart"](1,"tr"),g["\u0275\u0275elementStart"](2,"th"),g["\u0275\u0275text"](3,"Unid"),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](4,"th"),g["\u0275\u0275text"](5,"Producto"),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](6,"th"),g["\u0275\u0275text"](7,"Importe/unid"),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](8,"th"),g["\u0275\u0275text"](9,"Importe"),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](10,"th"),g["\u0275\u0275text"](11,"Desc"),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275template"](12,z,13,11,"tr",31),g["\u0275\u0275elementEnd"]()),2&e){const e=g["\u0275\u0275nextContext"](3);g["\u0275\u0275advance"](12),g["\u0275\u0275property"]("ngForOf",e.orderDetail.products)}}function R(e,t){if(1&e){const e=g["\u0275\u0275getCurrentView"]();g["\u0275\u0275elementStart"](0,"td"),g["\u0275\u0275elementStart"](1,"button",42),g["\u0275\u0275listener"]("click",function(){g["\u0275\u0275restoreView"](e);const t=g["\u0275\u0275nextContext"]().$implicit;return g["\u0275\u0275nextContext"](2).exportAsPDF(t)}),g["\u0275\u0275elementStart"](2,"mat-icon"),g["\u0275\u0275text"](3,"picture_as_pdf"),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"]()}if(2&e){const e=g["\u0275\u0275nextContext"]().$implicit;g["\u0275\u0275advance"](1),g["\u0275\u0275property"]("disabled",!e.payload.val().aproved)}}function B(e,t){if(1&e){const e=g["\u0275\u0275getCurrentView"]();g["\u0275\u0275elementStart"](0,"td"),g["\u0275\u0275elementStart"](1,"button",43),g["\u0275\u0275listener"]("click",function(){g["\u0275\u0275restoreView"](e);const t=g["\u0275\u0275nextContext"]().$implicit;return g["\u0275\u0275nextContext"](2).remove(t)}),g["\u0275\u0275elementStart"](2,"mat-icon"),g["\u0275\u0275text"](3,"delete"),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"]()}}function $(e,t){if(1&e){const e=g["\u0275\u0275getCurrentView"]();g["\u0275\u0275elementStart"](0,"tr"),g["\u0275\u0275elementStart"](1,"td"),g["\u0275\u0275text"](2),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](3,"td"),g["\u0275\u0275text"](4),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](5,"td"),g["\u0275\u0275text"](6),g["\u0275\u0275pipe"](7,"date"),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](8,"td"),g["\u0275\u0275text"](9),g["\u0275\u0275pipe"](10,"number"),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](11,"td"),g["\u0275\u0275text"](12),g["\u0275\u0275template"](13,U,2,1,"button",38),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](14,"td"),g["\u0275\u0275text"](15),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](16,"td"),g["\u0275\u0275text"](17),g["\u0275\u0275pipe"](18,"date"),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](19,"td"),g["\u0275\u0275text"](20),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](21,"td"),g["\u0275\u0275text"](22),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](23,"td"),g["\u0275\u0275elementStart"](24,"mat-accordion"),g["\u0275\u0275elementStart"](25,"mat-expansion-panel",39),g["\u0275\u0275listener"]("opened",function(){const t=g["\u0275\u0275restoreView"](e),n=t.$implicit,r=t.index;return g["\u0275\u0275nextContext"](2).expandOrderDetail(n,r)})("closed",function(){return g["\u0275\u0275restoreView"](e),g["\u0275\u0275nextContext"](2).isExpanded=!1}),g["\u0275\u0275elementStart"](26,"mat-expansion-panel-header"),g["\u0275\u0275elementStart"](27,"mat-panel-title"),g["\u0275\u0275text"](28," Detalle "),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275template"](29,L,13,1,"table",40),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275template"](30,R,4,1,"td",26),g["\u0275\u0275template"](31,B,4,0,"td",26),g["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,n=t.index,r=g["\u0275\u0275nextContext"](2);g["\u0275\u0275advance"](2),g["\u0275\u0275textInterpolate1"]("",e.payload.val().fantasyName,"\xa0\xa0"),g["\u0275\u0275advance"](2),g["\u0275\u0275textInterpolate1"]("",e.payload.val().seller,"\xa0\xa0"),g["\u0275\u0275advance"](2),g["\u0275\u0275textInterpolate1"]("",g["\u0275\u0275pipeBind2"](7,14,e.payload.val().date,"dd/MM/yyyy HH:mm"),"\xa0\xa0\xa0\xa0"),g["\u0275\u0275advance"](3),g["\u0275\u0275textInterpolate1"]("",g["\u0275\u0275pipeBind2"](10,17,e.payload.val().amountWithIva,"1.1-1"),"\xa0\xa0"),g["\u0275\u0275advance"](3),g["\u0275\u0275textInterpolate1"]("",e.payload.val().aproved?"SI":"NO","\xa0\xa0"),g["\u0275\u0275advance"](1),g["\u0275\u0275property"]("ngIf",null!=r.appUser&&r.appUser.isAdmin),g["\u0275\u0275advance"](2),g["\u0275\u0275textInterpolate1"]("%",e.payload.val().iva,"\xa0\xa0"),g["\u0275\u0275advance"](2),g["\u0275\u0275textInterpolate1"]("",e.payload.val().fullPaymentDate?g["\u0275\u0275pipeBind2"](18,20,e.payload.val().fullPaymentDate,"dd/MM/yyyy"):"NO","\xa0\xa0"),g["\u0275\u0275advance"](3),g["\u0275\u0275textInterpolate1"]("",e.payload.val().hasDiscount?"SI":"NO","\xa0\xa0"),g["\u0275\u0275advance"](2),g["\u0275\u0275textInterpolate1"]("",e.payload.val().clientInDebt?"SI":"NO","\xa0\xa0"),g["\u0275\u0275advance"](3),g["\u0275\u0275property"]("expanded",r.openAccordion===n),g["\u0275\u0275advance"](4),g["\u0275\u0275property"]("ngIf",r.orderDetail),g["\u0275\u0275advance"](1),g["\u0275\u0275property"]("ngIf",r.ordersService.clients),g["\u0275\u0275advance"](1),g["\u0275\u0275property"]("ngIf",r.appUser.isAdmin)}}function H(e,t){if(1&e){const e=g["\u0275\u0275getCurrentView"]();g["\u0275\u0275elementStart"](0,"button",44),g["\u0275\u0275listener"]("click",function(){g["\u0275\u0275restoreView"](e);const t=g["\u0275\u0275nextContext"](2);return t.downloadAll(t.currentItemsToShow)}),g["\u0275\u0275text"](1,"Descargar todos "),g["\u0275\u0275elementStart"](2,"mat-icon"),g["\u0275\u0275text"](3,"picture_as_pdf"),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"]()}}const _=function(){return[10,20]};function W(e,t){if(1&e){const e=g["\u0275\u0275getCurrentView"]();g["\u0275\u0275elementStart"](0,"mat-paginator",45),g["\u0275\u0275listener"]("page",function(t){return g["\u0275\u0275restoreView"](e),g["\u0275\u0275nextContext"](2).onPageChange(t)}),g["\u0275\u0275elementEnd"]()}if(2&e){const e=g["\u0275\u0275nextContext"](2);g["\u0275\u0275property"]("length",e.filteredOrders.length)("pageSize",10)("pageSizeOptions",g["\u0275\u0275pureFunction0"](3,_))}}function G(e,t){if(1&e){const e=g["\u0275\u0275getCurrentView"]();g["\u0275\u0275elementStart"](0,"div",2),g["\u0275\u0275elementStart"](1,"div",3),g["\u0275\u0275elementStart"](2,"div",4),g["\u0275\u0275elementStart"](3,"h1"),g["\u0275\u0275text"](4,"PEDIDOS"),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](5,"div",5),g["\u0275\u0275elementStart"](6,"a",6),g["\u0275\u0275elementStart"](7,"mat-icon"),g["\u0275\u0275text"](8,"control_point"),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](9,"span"),g["\u0275\u0275text"](10,"Crear Pedido"),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275template"](11,b,5,1,"div",7),g["\u0275\u0275template"](12,D,17,1,"div",8),g["\u0275\u0275elementEnd"](),g["\u0275\u0275element"](13,"hr"),g["\u0275\u0275elementStart"](14,"div",3),g["\u0275\u0275elementStart"](15,"div",3),g["\u0275\u0275elementStart"](16,"div",5),g["\u0275\u0275elementStart"](17,"div",9),g["\u0275\u0275elementStart"](18,"div"),g["\u0275\u0275elementStart"](19,"mat-icon",10),g["\u0275\u0275text"](20,"search"),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](21,"input",11,12),g["\u0275\u0275listener"]("ngModelChange",function(t){return g["\u0275\u0275restoreView"](e),g["\u0275\u0275nextContext"]().clientValue=t})("ngModelChange",function(){g["\u0275\u0275restoreView"](e);const t=g["\u0275\u0275reference"](22);return g["\u0275\u0275nextContext"]().filter(t.value)})("keyup",function(){g["\u0275\u0275restoreView"](e);const t=g["\u0275\u0275reference"](22);return g["\u0275\u0275nextContext"]().filter(t.value)}),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](23,"div",5),g["\u0275\u0275elementStart"](24,"div",9),g["\u0275\u0275elementStart"](25,"div"),g["\u0275\u0275elementStart"](26,"mat-icon",10),g["\u0275\u0275text"](27,"search"),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](28,"input",13,14),g["\u0275\u0275listener"]("ngModelChange",function(t){return g["\u0275\u0275restoreView"](e),g["\u0275\u0275nextContext"]().sellerValue=t})("keyup",function(){g["\u0275\u0275restoreView"](e);const t=g["\u0275\u0275reference"](29);return g["\u0275\u0275nextContext"]().filterBySeller(t.value)}),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](30,"div",5),g["\u0275\u0275elementStart"](31,"div",9),g["\u0275\u0275elementStart"](32,"div"),g["\u0275\u0275elementStart"](33,"mat-icon",10),g["\u0275\u0275text"](34,"search"),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](35,"input",15,16),g["\u0275\u0275listener"]("ngModelChange",function(t){return g["\u0275\u0275restoreView"](e),g["\u0275\u0275nextContext"]().dateValue=t})("keyup",function(){g["\u0275\u0275restoreView"](e);const t=g["\u0275\u0275reference"](36);return g["\u0275\u0275nextContext"]().filterByDate(t.value)}),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](37,"div",17),g["\u0275\u0275elementStart"](38,"form",18,19),g["\u0275\u0275listener"]("ngSubmit",function(){g["\u0275\u0275restoreView"](e);const t=g["\u0275\u0275nextContext"]();return t.searchDateRange(t.range.value)}),g["\u0275\u0275elementStart"](40,"mat-form-field",20),g["\u0275\u0275elementStart"](41,"mat-label"),g["\u0275\u0275text"](42,"Ingrese un rango de fechas"),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](43,"mat-date-range-input",21),g["\u0275\u0275element"](44,"input",22),g["\u0275\u0275element"](45,"input",23),g["\u0275\u0275elementEnd"](),g["\u0275\u0275element"](46,"mat-datepicker-toggle",24),g["\u0275\u0275element"](47,"mat-date-range-picker",null,25),g["\u0275\u0275template"](49,N,2,0,"mat-error",26),g["\u0275\u0275template"](50,V,2,0,"mat-error",26),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](51,"button",27),g["\u0275\u0275text"](52,"buscar por rango"),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](53,"button",28,12),g["\u0275\u0275listener"]("click",function(){return g["\u0275\u0275restoreView"](e),g["\u0275\u0275nextContext"]().clearRange()}),g["\u0275\u0275text"](55,"borrar b\xfasqueda"),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](56,"div",29),g["\u0275\u0275elementStart"](57,"table",30),g["\u0275\u0275elementStart"](58,"thead"),g["\u0275\u0275elementStart"](59,"tr"),g["\u0275\u0275elementStart"](60,"th"),g["\u0275\u0275text"](61,"Cliente"),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](62,"th"),g["\u0275\u0275text"](63,"Vendedor"),g["\u0275\u0275elementEnd"](),g["\u0275\u0275template"](64,A,2,0,"th",26),g["\u0275\u0275template"](65,M,2,0,"th",26),g["\u0275\u0275template"](66,k,2,0,"th",26),g["\u0275\u0275template"](67,q,2,0,"th",26),g["\u0275\u0275template"](68,F,2,0,"th",26),g["\u0275\u0275template"](69,P,2,0,"th",26),g["\u0275\u0275template"](70,T,2,0,"th",26),g["\u0275\u0275elementStart"](71,"th"),g["\u0275\u0275text"](72,"Detalle"),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](73,"tbody"),g["\u0275\u0275template"](74,$,32,23,"tr",31),g["\u0275\u0275elementStart"](75,"tr"),g["\u0275\u0275elementStart"](76,"th"),g["\u0275\u0275text"](77,"TOTAL"),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](78,"th"),g["\u0275\u0275text"](79),g["\u0275\u0275pipe"](80,"number"),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275template"](81,H,4,0,"button",32),g["\u0275\u0275template"](82,W,1,4,"mat-paginator",33),g["\u0275\u0275elementEnd"]()}if(2&e){const e=g["\u0275\u0275reference"](48),t=g["\u0275\u0275nextContext"]();g["\u0275\u0275advance"](11),g["\u0275\u0275property"]("ngIf",t.ordersNotAproved>0),g["\u0275\u0275advance"](1),g["\u0275\u0275property"]("ngIf",t.ordersNotAproved>0),g["\u0275\u0275advance"](9),g["\u0275\u0275property"]("ngModel",t.clientValue),g["\u0275\u0275advance"](7),g["\u0275\u0275property"]("ngModel",t.sellerValue),g["\u0275\u0275advance"](7),g["\u0275\u0275property"]("ngModel",t.dateValue),g["\u0275\u0275advance"](8),g["\u0275\u0275property"]("formGroup",t.range)("rangePicker",e),g["\u0275\u0275advance"](3),g["\u0275\u0275property"]("for",e),g["\u0275\u0275advance"](3),g["\u0275\u0275property"]("ngIf",t.range.controls.start.hasError("matStartDateInvalid")),g["\u0275\u0275advance"](1),g["\u0275\u0275property"]("ngIf",t.range.controls.end.hasError("matEndDateInvalid")),g["\u0275\u0275advance"](14),g["\u0275\u0275property"]("ngIf",!t.isExpanded),g["\u0275\u0275advance"](1),g["\u0275\u0275property"]("ngIf",!t.isExpanded),g["\u0275\u0275advance"](1),g["\u0275\u0275property"]("ngIf",!t.isExpanded),g["\u0275\u0275advance"](1),g["\u0275\u0275property"]("ngIf",!t.isExpanded),g["\u0275\u0275advance"](1),g["\u0275\u0275property"]("ngIf",!t.isExpanded),g["\u0275\u0275advance"](1),g["\u0275\u0275property"]("ngIf",!t.isExpanded),g["\u0275\u0275advance"](1),g["\u0275\u0275property"]("ngIf",!t.isExpanded),g["\u0275\u0275advance"](4),g["\u0275\u0275property"]("ngForOf",t.currentItemsToShow),g["\u0275\u0275advance"](5),g["\u0275\u0275textInterpolate1"]("$",g["\u0275\u0275pipeBind2"](80,21,t.getTotal(),"1.1-1"),""),g["\u0275\u0275advance"](2),g["\u0275\u0275property"]("ngIf",t.currentItemsToShow),g["\u0275\u0275advance"](1),g["\u0275\u0275property"]("ngIf",t.filteredOrders)}}function j(e,t){if(1&e&&(g["\u0275\u0275elementStart"](0,"tr"),g["\u0275\u0275elementStart"](1,"td"),g["\u0275\u0275text"](2),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](3,"td"),g["\u0275\u0275text"](4),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](5,"td",48),g["\u0275\u0275text"](6),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;g["\u0275\u0275advance"](2),g["\u0275\u0275textInterpolate"](e.debtorName),g["\u0275\u0275advance"](2),g["\u0275\u0275textInterpolate"](e.orderDate),g["\u0275\u0275advance"](2),g["\u0275\u0275textInterpolate"](e.orderDebt)}}function K(e,t){if(1&e){const e=g["\u0275\u0275getCurrentView"]();g["\u0275\u0275elementStart"](0,"div",46),g["\u0275\u0275elementStart"](1,"h2"),g["\u0275\u0275text"](2,"Estimado vendedor: los siguientes clientes tienen deuda. Por favor regularice la situaci\xf3n."),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](3,"table",30),g["\u0275\u0275elementStart"](4,"tr"),g["\u0275\u0275elementStart"](5,"th"),g["\u0275\u0275text"](6,"Cliente"),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](7,"th"),g["\u0275\u0275text"](8,"Fecha del pedido en deuda"),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](9,"th"),g["\u0275\u0275text"](10,"Monto del pedido"),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275template"](11,j,7,3,"tr",31),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](12,"button",47),g["\u0275\u0275listener"]("click",function(){g["\u0275\u0275restoreView"](e);const t=g["\u0275\u0275nextContext"]();return t.debtWarning=!t.debtWarning}),g["\u0275\u0275text"](13,"Aceptar"),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"]()}if(2&e){const e=g["\u0275\u0275nextContext"]();g["\u0275\u0275advance"](11),g["\u0275\u0275property"]("ngForOf",e.debtors)}}const Y=[{path:"",component:(()=>{class e{constructor(e,t,n,r,l){this.ordersService=e,this.auth=t,this.datepipe=n,this.stockService=r,this.dateAdapter=l,this.range=new a.FormGroup({start:new a.FormControl,end:new a.FormControl}),this.recentUserOrders=[],this.userOrders=[],this.ordersNotAproved=0,this.notAprovedOrders=[],this.query={client:"",seller:"",date:"",dateRange:{start:new Date(2017,1,1),end:new Date(2040,1,1)}},this.isExpanded=!1,this.debtWarning=!1,this.openAccordion=-1,this.dateAdapter.setLocale("en-GB")}ngOnInit(){this.orders=this.ordersService.orders,this.subscription=this.auth.appUser$.subscribe(e=>{this.appUser=e,this.ordersService.getAllOrders().subscribe(e=>{this.orders=e,this.userClients=this.ordersService.getUserClients(this.appUser.name),this.recentUserOrders=[],this.userOrders=[],this.debtors=[],this.dateRangefilteredOrders=[],this.currentItemsToShow=[],this.notAprovedOrders=[],this.ordersNotAproved=0;for(let l=0;l<this.orders.length;l++){let e=this.orders[l].payload.val().seller==this.appUser.name,t=this.isClientInUserClients(this.orders[l].payload.val().fantasyName,this.userClients),n=Date.now()-this.orders[l].payload.val().date<24*h.g*60*60*1e3;this.appUser&&(this.appUser.isAdmin||this.appUser.isSalesManager||e||t)&&(this.userOrders.push(this.orders[l]),0==this.orders[l].payload.val().aproved&&(this.notAprovedOrders.push(this.orders[l].payload.val()),this.ordersNotAproved+=1)),this.appUser&&(this.appUser.isAdmin||this.appUser.isSalesManager||e||t)&&n&&this.recentUserOrders.push(this.orders[l])}for(let l=0;l<this.recentUserOrders.length;l++)if(this.ordersService.isClientInDebt(this.recentUserOrders[l].payload.val().fantasyName,this.recentUserOrders)){this.debtors=[];let e=new Date(this.recentUserOrders[l].payload.val().date);this.debtors.push({debtorName:this.recentUserOrders[l].payload.val().fantasyName,orderDate:e.getDate()+"/"+e.getMonth()+"/"+e.getFullYear(),orderDebt:this.recentUserOrders[l].payload.val().amountWithIva}),this.debtWarning=!0}this.dateRangefilteredOrders=this.datefilteredOrders=this.filteredOrders=this.recentUserOrders,this.currentItemsToShow=this.filteredOrders;let t=(new Date).getDate().toString(),n=(new Date).getMonth()+1,r=(new Date).getFullYear(),a=n.toString();n<10&&(a="0"+n.toString()),this.dateValue=t+"/"+a+"/"+r,this.filterByDate(this.dateValue),this.onPageChange({previousPageIndex:0,pageIndex:0,pageSize:10,length:this.filteredOrders.length}),this.ordersService.fantasyName&&(this.dateValue="",this.clientValue=this.ordersService.fantasyName,this.filter(this.ordersService.fantasyName),this.ordersService.fantasyName="",this.filterByDate(""))})})}expandOrderDetail(e,t){this.openAccordion=this.openAccordion===t?-1:t,this.orderDetail=this.ordersService.getOrderDetail(e.payload.val().orderDetailKey).payload.val()}filter(e){var t;this.query.client=e,this.filteredOrders=[];for(let n=0;n<this.userOrders.length;n++)this.userOrders[n].payload.val().fantasyName.toLowerCase().includes(e.toLowerCase())&&this.userOrders[n].payload.val().seller.toLowerCase().includes(this.query.seller.toLowerCase())&&(null===(t=this.datepipe.transform(this.userOrders[n].payload.val().date,"dd/MM/yyyy HH:mm"))||void 0===t?void 0:t.includes(this.query.date))&&this.filteredOrders.push(this.userOrders[n]);this.filteredOrders.filter(e=>e.payload.val().date>this.query.dateRange.start.getTime()&&e.payload.val().date<this.query.dateRange.start.getTime()),this.onPageChange({previousPageIndex:0,pageIndex:0,pageSize:10,length:this.filteredOrders.length}),this.paginator&&(this.paginator.pageIndex=0)}filterBySeller(e){var t;this.query.seller=e,this.filteredOrders=[];for(let n=0;n<this.userOrders.length;n++)this.userOrders[n].payload.val().fantasyName.toLowerCase().includes(this.query.client.toLowerCase())&&this.userOrders[n].payload.val().seller.toLowerCase().includes(e.toLowerCase())&&(null===(t=this.datepipe.transform(this.userOrders[n].payload.val().date,"dd/MM/yyyy HH:mm"))||void 0===t?void 0:t.includes(this.query.date))&&this.filteredOrders.push(this.userOrders[n]);this.filteredOrders.filter(e=>e.payload.val().date>this.query.dateRange.start.getTime()&&e.payload.val().date<this.query.dateRange.start.getTime()),this.onPageChange({previousPageIndex:0,pageIndex:0,pageSize:10,length:this.filteredOrders.length}),this.paginator&&(this.paginator.pageIndex=0)}filterByDate(e){var t;this.query.date=e,this.filteredOrders=[];for(let n=0;n<this.userOrders.length;n++)this.userOrders[n].payload.val().fantasyName.toLowerCase().includes(this.query.client.toLowerCase())&&this.userOrders[n].payload.val().seller.toLowerCase().includes(this.query.seller.toLowerCase())&&(null===(t=this.datepipe.transform(this.userOrders[n].payload.val().date,"dd/MM/yyyy HH:mm"))||void 0===t?void 0:t.includes(e))&&this.filteredOrders.push(this.userOrders[n]);this.filteredOrders.filter(e=>e.payload.val().date>this.query.dateRange.start.getTime()&&e.payload.val().date<this.query.dateRange.start.getTime()),this.onPageChange({previousPageIndex:0,pageIndex:0,pageSize:10,length:this.filteredOrders.length}),this.paginator&&(this.paginator.pageIndex=0)}searchDateRange(e){var t,n,r;if(e.start){this.filteredOrders=[];for(let e=0;e<this.userOrders.length;e++)this.userOrders[e].payload.val().fantasyName.toLowerCase().includes(this.query.client.toLowerCase())&&this.userOrders[e].payload.val().seller.toLowerCase().includes(this.query.seller.toLowerCase())&&(null===(t=this.datepipe.transform(this.userOrders[e].payload.val().date,"dd/MM/yyyy HH:mm"))||void 0===t?void 0:t.includes(this.query.date))&&this.filteredOrders.push(this.userOrders[e]);this.filteredOrders=e?this.filteredOrders.filter(t=>t.payload.val().date>Date.parse(e.start._d)&&t.payload.val().date<Date.parse(e.end._d)):this.filteredOrders,this.query.dateRange.start=new Date(Date.parse(null===(n=e.start)||void 0===n?void 0:n._d)),this.query.dateRange.end=new Date(Date.parse(null===(r=e.end)||void 0===r?void 0:r._d))}this.onPageChange({previousPageIndex:0,pageIndex:0,pageSize:10,length:this.filteredOrders.length}),this.paginator&&(this.paginator.pageIndex=0)}onPageChange(e){this.currentItemsToShow=this.filteredOrders.slice(e.pageIndex*e.pageSize,e.pageIndex*e.pageSize+e.pageSize)}getTitle(e){return e.title}compare(e,t,n){return(e<t?-1:1)*(n?1:-1)}getTotal(){let e=0;return this.filteredOrders&&this.filteredOrders.forEach(t=>{e+=parseFloat(t.payload.val().amountWithIva)}),e}aprove(e){if(confirm("Est\xe1 segur@ que quiere aprobar el pedido para que pueda ser entregada la mercader\xeda?")){if(e.payload.val().clientInDebt&&!this.appUser.isOwner)return;this.stockService.aprove(e),this.ordersService.aproveOrder(e)}}clearRange(){this.range.setValue({start:null,end:null}),this.sellerValue="",this.clientValue="",this.dateValue="",this.filterByDate(this.dateValue),this.onPageChange({previousPageIndex:0,pageIndex:0,pageSize:10,length:this.filteredOrders.length}),this.paginator&&(this.paginator.pageIndex=0)}isOrderInDebt(e){return this.ordersService.isOrderInDebt(e)}toggleAccordion(e){this.dateValue="",this.query.client="",this.query.date="";let t=this.userOrders.filter(t=>t.payload.val().date==e.date);this.currentItemsToShow=t,window.scrollBy({top:window.innerHeight,behavior:"smooth"})}exportAsPDF(e){let t=this.ordersService.getOrderDetail(e.payload.val().orderDetailKey).payload.val().products,n=new Date(e.payload.val().date),r=String(n.getDate()).padStart(2,"0")+"/"+String(n.getMonth()+1).padStart(2,"0")+"/"+n.getFullYear();const a=50;let l=this.ordersService.getAddress(e.payload.val().fantasyName);var i=new c.kH;i.setFontSize(10),i.text("GENTECH MAR DEL PLATA",10,20),i.text("FECHA DEL PEDIDO: "+r,70,20),i.text("FACT N\xba: "+e.payload.val().orderNumber,140,20),i.setFontSize(7),i.text("CLIENTE: "+e.payload.val().fantasyName,10,30),i.text("VENDEDOR: "+e.payload.val().seller,70,30),i.text("DIRECCI\xd3N: "+l,140,30),i.setFontSize(10),i.text("---------------------------------------------------------------------------------------------------------------------------------------------------------------------",10,35),i.text("Cantidad",10,40),i.text("Producto",30,40);let d=0;"Gimnasio"!=this.ordersService.getClientCategory(e.payload.val().fantasyName)&&"Kiosko"!=this.ordersService.getClientCategory(e.payload.val().fantasyName)?i.text("Importe+iva",185,40):d=30,i.text("Importe/uni",125+d,40),i.text("Importe",155+d,40);let o=0;for(let m=0;m<t.length;m++)if(0!=t[m].quantity){let n=t[m].discountPrice*t[m].quantity;i.text(t[m].quantity.toString(),10,a+10*o),i.text(t[m].title,30,a+10*o),d=0,"Gimnasio"!=this.ordersService.getClientCategory(e.payload.val().fantasyName)&&"Kiosko"!=this.ordersService.getClientCategory(e.payload.val().fantasyName)?i.text("$"+(n*(1+e.payload.val().iva/100)).toFixed(1),185,a+10*o):d=30,i.text("$"+t[m].discountPrice.toFixed(1),125+d,a+10*o),i.text("$"+n.toFixed(1),155+d,a+10*o),o+=1}let s=a+10*o+10;i.text("---------------------------------------------------------------------------------------------------------------------------------------------------------------------",10,s-5),"Gimnasio"!=this.ordersService.getClientCategory(e.payload.val().fantasyName)&&"Kiosko"!=this.ordersService.getClientCategory(e.payload.val().fantasyName)?i.text("TOTAL CON IVA "+e.payload.val().iva+"%       $"+(this.ordersService.getTotalAmount(t)*(1+e.payload.val().iva/100)).toFixed(1),10,s):i.text("TOTAL $"+(this.ordersService.getTotalAmount(t)*(1+e.payload.val().iva/100)).toFixed(1),10,s),i.save(`${e.payload.val().fantasyName} ${r}.pdf`)}remove(e){confirm("Est\xe1 segur@ que quiere eliminar este pedido? Se restar\xe1 el monto del pedido a la deuda del cliente")&&this.ordersService.removeOrder(e)}isClientInUserClients(e,t){for(let n=0;n<t.length;n++)if(e.toLowerCase().includes(t[n].toLowerCase()))return!0;return!1}downloadAll(e){e.forEach(e=>{this.exportAsPDF(e)})}ngOnDestroy(){this.subscription.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(g["\u0275\u0275directiveInject"](s.N),g["\u0275\u0275directiveInject"](v.e),g["\u0275\u0275directiveInject"](r.uU),g["\u0275\u0275directiveInject"](f.q),g["\u0275\u0275directiveInject"](y._A))},e.\u0275cmp=g["\u0275\u0275defineComponent"]({type:e,selectors:[["orders"]],viewQuery:function(e,t){if(1&e&&g["\u0275\u0275viewQuery"](u.NW,5),2&e){let e;g["\u0275\u0275queryRefresh"](e=g["\u0275\u0275loadQuery"]())&&(t.paginator=e.first)}},decls:3,vars:2,consts:[["class","SCContainer ms-1",4,"ngIf","ngIfElse"],["elseBlock",""],[1,"SCContainer","ms-1"],[1,"row"],[1,"col-6","col-md-4","my-2"],[1,"col-6","col-md-4","my-1"],["mat-icon-button","","routerLink","/orders/order"],["class","col my-2",4,"ngIf"],["class","row",4,"ngIf"],[1,"input-group"],["matSuffix",""],["type","text","placeholder","   Nombre de Fantas\xeda...",1,"border-end-0","border","rounded-pill",3,"ngModel","ngModelChange","keyup"],["query",""],["type","text","placeholder","   Vendedor...",1,"border-end-0","border","rounded-pill",3,"ngModel","ngModelChange","keyup"],["sellerquery",""],["type","text","placeholder","   Fecha...",1,"border-end-0","border","rounded-pill",3,"ngModel","ngModelChange","keyup"],["Datequery",""],[1,"row","m-3"],[3,"ngSubmit"],["f","ngForm"],["appearance","fill"],[3,"formGroup","rangePicker"],["matStartDate","","formControlName","start","placeholder","fecha inicio"],["matEndDate","","formControlName","end","placeholder","fecha finalizaci\xf3n"],["matSuffix","",3,"for"],["picker",""],[4,"ngIf"],["mat-raised-button","","type","submit","color","primary"],["mat-raised-button","","color","accent",3,"click"],[1,"table-responsive"],[1,"table","table-striped","table-sm","mat-elevation-z8"],[4,"ngFor","ngForOf"],["mat-raised-button","","color","primary",3,"click",4,"ngIf"],[3,"length","pageSize","pageSizeOptions","page",4,"ngIf"],[1,"col","my-2"],["matBadgeSize","large",3,"matBadge"],["hideToggle",""],["routerLink","/orders/orders",3,"click"],[3,"disabled","click",4,"ngIf"],["hideToggle","",3,"expanded","opened","closed"],["class","table table-striped table-sm mat-elevation-z8",4,"ngIf"],[3,"disabled","click"],["mat-icon-button","","color","primary",3,"disabled","click"],["mat-icon-button","","color","accent",3,"click"],["mat-raised-button","","color","primary",3,"click"],[3,"length","pageSize","pageSizeOptions","page"],[1,"SCContainer"],["mat-raised-button","","color","primary",2,"margin","20px",3,"click"],[1,"text-danger"]],template:function(e,t){if(1&e&&(g["\u0275\u0275template"](0,G,83,24,"div",0),g["\u0275\u0275template"](1,K,14,1,"ng-template",null,1,g["\u0275\u0275templateRefExtractor"])),2&e){const e=g["\u0275\u0275reference"](2);g["\u0275\u0275property"]("ngIf",t.appUser&&(!t.debtWarning||t.appUser.isAdmin))("ngIfElse",e)}},directives:[r.O5,x.zs,m.yS,S.Hw,E.R9,a.DefaultValueAccessor,a.NgControlStatus,a.NgModel,a["\u0275NgNoValidate"],a.NgControlStatusGroup,a.NgForm,E.KE,E.hX,C.wx,a.FormGroupDirective,C.zY,a.FormControlName,C.By,C.nW,C._g,x.lW,r.sg,I.k,O.pp,O.ib,O.yz,O.yK,E.TO,u.NW],pipes:[r.JJ,r.uU],styles:["td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{text-align:left;border-bottom:1px solid #ddd}table[_ngcontent-%COMP%]{border:1px solid #000;border-radius:1%}"]}),e})(),canActivate:[p.a]}];let Q=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=g["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=g["\u0275\u0275defineInjector"]({imports:[[m.Bz.forChild(Y)],m.Bz]}),e})(),J=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=g["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=g["\u0275\u0275defineInjector"]({providers:[i.H,d.t,s.N],imports:[[r.ez,Q,a.FormsModule,l.q,a.ReactiveFormsModule,o.t]]}),e})()}}]);