{"version":3,"sources":["./src/app/buy/buy.component.html","./src/app/buy/buy.component.ts","./src/app/modules/buy-lazy/buy-lazy-routing.module.ts","./src/app/modules/buy-lazy/buy-lazy.module.ts"],"names":[],"mappings":"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","file":"src_app_modules_buy-lazy_buy-lazy_module_ts.js","sourcesContent":["<div class=\"container-grid\">\r\n  <div class=\"ms-3 row\">\r\n    <div class=\"col-3\">\r\n      <h1>Nueva Compra</h1>\r\n    </div>\r\n    <div *ngIf=\"orderProducts\" class=\"col-3\">\r\n      <h3>Cantidad Total: {{orderProducts.buyItemsCount}}</h3>\r\n    </div>\r\n  </div>\r\n  <div class=\"ms-3\">\r\n    <product-filter></product-filter>\r\n  </div>\r\n  <div class=\"col-4 col-sm-3 m-3 col-lg-3\">\r\n    <div class=\"input-group\">\r\n      <div>\r\n        <mat-icon matSuffix>search</mat-icon>\r\n      </div>\r\n      <div><input matInput class=\"border-end-0 border rounded-pill\" #prodQuery (keyup)=\"filter(prodQuery.value)\" type=\"text\" placeholder=\"   Buscar producto...\"></div>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"ms-3 mb-3\">\r\n    <button class=\"left-btn\" (click)=\"sendBuy()\" mat-raised-button color=\"basic\">Cargar compra</button>\r\n    <button class=\"left-btn\" (click)=\"reset()\" mat-raised-button color=\"warn\">Anular </button>\r\n  </div>\r\n  <div class=\"ms-3\">\r\n    <span *ngIf=\"buyEmpty\" class=\"text-danger border border-danger p-2 mt-5 mb-5 rounded\">Agregue productos a la compra</span>\r\n    <table class=\"mt-3\" matSort (matSortChange)=\"sortData($event)\">\r\n      <tr>\r\n        <th mat-sort-header=\"title\">Producto</th>\r\n        <th mat-sort-header=\"quantity\">Cantidad</th>\r\n        <th mat-sort-header=\"stock\">Stock actual</th>\r\n      </tr>\r\n\r\n      <tr *ngFor=\"let p of showedProducts\">\r\n        <td style=\"max-width: 280px;\">{{p.product.title}}&nbsp;&nbsp;&nbsp;&nbsp;</td>\r\n        <td><input #amount=\"ngModel\" matInput [(ngModel)]=\"p.quantity\" name=\"amount\" placeholder=\"{{p.quantity}}\" (blur)=\"setBuyItemQuantity(p, p.quantity)\"></td>\r\n        <td>{{getQuantityOfP(p)}}</td>\r\n        <button class=\"left-btn\" (click)=\"updateBuyItemQuantity(p, -1)\" mat-raised-button color=\"basic\">-</button>\r\n        <button class=\"left-btn\" (click)=\"updateBuyItemQuantity(p, 1)\" mat-raised-button color=\"basic\">+</button>\r\n      </tr>\r\n    </table>\r\n  </div>\r\n\r\n\r\n  <div class=\"ms-3\">\r\n    <button class=\"left-btn\" (click)=\"sendBuy()\" mat-raised-button color=\"basic\" routerLink=\"/stock/stock\">Cargar compra</button>\r\n    <button class=\"left-btn\" (click)=\"reset()\" mat-raised-button color=\"warn\">Anular </button>\r\n  </div>\r\n\r\n\r\n</div>\r\n\r\n\r\n","import { Component, OnInit } from '@angular/core';\r\nimport { Sort } from '@angular/material/sort';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { Subscription } from 'rxjs';\r\nimport { AppUser } from '../models/app-user';\r\nimport { AuthService } from '../services/auth.service';\r\nimport { ProductService } from '../services/product.service';\r\nimport { StockService } from '../services/stock.service';\r\n\r\n@Component({\r\n  selector: 'app-buy',\r\n  templateUrl: './buy.component.html',\r\n  styleUrls: ['./buy.component.scss']\r\n})\r\nexport class BuyComponent implements OnInit {\r\n\r\n  appUser: AppUser;\r\n  buy: any;\r\n  filteredBuy:any;\r\n  products:any;\r\n  orderProducts: {buyItemsCount: number, products: any};\r\n  products$:any;\r\n  prodsCategory: string | null;\r\n  sortedData: any[];\r\n  prodQuery: string;\r\n  showedProducts:any;\r\n  subscription: Subscription;\r\n  subscription2: Subscription\r\n  subscription3: Subscription\r\n  subscription4: Subscription\r\n\r\n  buyEmpty: boolean = false;\r\n\r\n  constructor(public stockService: StockService,\r\n    private productService: ProductService,\r\n    private route: ActivatedRoute,\r\n    private router: Router,\r\n    private auth: AuthService) {\r\n    }\r\n\r\n  ngOnInit() {\r\n    this.subscription2 = this.auth.appUser$.subscribe(appUser => {\r\n      this.appUser = appUser;\r\n      this.subscription3 = this.productService.getAllProducts().subscribe(products => {\r\n        this.products = products;\r\n        //this.subscription = this.stockService.getBuy().subscribe(buy => {\r\n          // this.buy = buy;\r\n          this.orderProducts = this.buildOrderProducts(this.products);\r\n          this.subscription4 = this.route.queryParamMap.subscribe(params => {\r\n            this.prodsCategory = params.get('prodsCategory');\r\n            this.filteredBuy = [];\r\n            if (this.orderProducts) {\r\n              for (let i=0;i<this.orderProducts.products.length;i++) {\r\n                if (this.orderProducts.products[i].product.prodsCategory == this.prodsCategory)  {\r\n                  this.filteredBuy.push(this.orderProducts.products[i]);\r\n                }\r\n              }\r\n              if (this.filteredBuy.length == 0) {\r\n                for (let i=0;i<this.orderProducts.products.length;i++)\r\n                  this.filteredBuy.push(this.orderProducts.products[i]);\r\n              }\r\n              this.showedProducts = this.filteredBuy;\r\n            }\r\n          });\r\n        //});\r\n      })\r\n    });\r\n  }\r\n\r\n  filter(prodQuery: string) {\r\n    this.prodQuery = prodQuery;\r\n    if (prodQuery=='') {\r\n      // this.showedProducts = this.filteredOrder;\r\n      this.showedProducts = this.filteredBuy;\r\n      return\r\n    }\r\n    this.showedProducts = (prodQuery) ?\r\n    this.showedProducts.filter((p: any) => p.product.title.toLowerCase().includes(prodQuery.toLowerCase())) :\r\n    this.showedProducts;\r\n  }\r\n\r\n  buildOrderProducts(products: any) {\r\n    let prods: any[] = []\r\n    products.forEach((p: any) => {\r\n      let prod = {\r\n        price: p.payload.val().buyPrice,\r\n        product: p.payload.val(),\r\n        productId: p.key,\r\n        quantity: 0\r\n      }\r\n      prods.push(prod)\r\n    });\r\n    let orderProducts = { buyItemsCount: 0, products: prods }\r\n    return orderProducts;\r\n  }\r\n\r\n  updateBuyItemQuantity(product: any, change: number){\r\n    for (let i=0;i<this.orderProducts.products.length;i++) {\r\n      if (this.orderProducts.products[i].productId == product.productId) {\r\n        this.orderProducts.products[i].quantity += change\r\n      }\r\n    }\r\n    this.orderProducts.buyItemsCount += change\r\n  }\r\n\r\n  setBuyItemQuantity(product: any, quantity: string) {\r\n    let quan = parseInt(quantity)\r\n    for (let i=0;i<this.orderProducts.products.length;i++) {\r\n      if (this.orderProducts.products[i].productId == product.productId) {\r\n        if (!Number.isInteger(quan)) {\r\n          this.orderProducts.products[i].quantity = 0;\r\n          return\r\n        }\r\n        this.orderProducts.products[i].quantity = quan;\r\n      }\r\n    }\r\n    this.orderProducts.buyItemsCount += parseInt(quantity)\r\n  }\r\n\r\n  sortData(sort: Sort) {\r\n    const data = this.filteredBuy;\r\n    if (!sort.active || sort.direction === '') {\r\n      this.sortedData = data;\r\n      return;\r\n    }\r\n\r\n    this.sortedData = data.sort((a: any, b: any) => {\r\n      const isAsc = sort.direction === 'asc';\r\n      switch (sort.active) {\r\n        case 'title': return this.compare(a.payload.val().product.title, b.payload.val().product.title, isAsc);\r\n        case 'quantity': return this.compare(a.payload.val().quantity, b.payload.val().quantity, isAsc);\r\n        case 'stock': return this.compare(this.getQuantityOfP(a), this.getQuantityOfP(b), isAsc);\r\n        default: return 0;\r\n      }\r\n    });\r\n  }\r\n\r\n  compare(a: number | string, b: number | string, isAsc: boolean) {\r\n    return (a < b ? -1 : 1) * (isAsc ? 1 : -1);\r\n  }\r\n\r\n  sendBuy() {\r\n    // if (parseInt(this.buy[0].payload.val().buyItemsCount) == 0) {\r\n    //   this.buyEmpty = true;\r\n    //   setTimeout(()=> {\r\n    //     this.buyEmpty = false;\r\n    //   }, 2000)\r\n    //   return;\r\n    // }\r\n    // if (confirm('Está segur@ que quiere cargar la compra? No podrá modificarla')) {\r\n    //   this.stockService.sendBuy(this.buy);\r\n    //   this.productService.updateStocks(this.buy[0].payload.val().products, this.products, true);\r\n    //   this.router.navigate(['/stock/stock'])\r\n    // }\r\n\r\n    if (this.orderProducts.buyItemsCount == 0) {\r\n      this.buyEmpty = true;\r\n      setTimeout(()=> {\r\n        this.buyEmpty = false;\r\n      }, 2000)\r\n      return;\r\n    }\r\n    if (confirm('Está segur@ que quiere cargar la compra? No podrá modificarla')) {\r\n      this.stockService.sendBuy(this.orderProducts);\r\n      this.productService.updateStocks(this.orderProducts.products, this.products, true);\r\n      this.router.navigate(['/stock/stock'])\r\n    }\r\n  }\r\n\r\n  reset() {\r\n    if (confirm('Está segur@ que quiere anular la compra? aun no fue cargada')) {\r\n    this.stockService.reset();\r\n    }\r\n  }\r\n\r\n  getQuantityOfP(pBuy: any) {\r\n    return this.stockService.getQuantityOfP(pBuy);\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    //this.subscription.unsubscribe();\r\n    this.subscription2.unsubscribe();\r\n    this.subscription3.unsubscribe();\r\n    this.subscription4.unsubscribe();\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { RouterModule, Routes } from '@angular/router';\r\nimport { BuyComponent } from 'src/app/buy/buy.component';\r\nimport { AuthGuard } from 'src/app/services/auth-guard.service';\r\n\r\nconst routes: Routes = [{ path: '', component: BuyComponent, canActivate: [AuthGuard] }];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule]\r\n})\r\nexport class BuyLazyRoutingModule { }\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { BuyLazyRoutingModule } from './buy-lazy-routing.module';\r\nimport { BuyComponent } from 'src/app/buy/buy.component';\r\nimport { MaterialModule } from 'src/app/Material/Material.module';\r\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\r\nimport { ProductFilterModule } from '../product-filter/product-filter.module';\r\n\r\n\r\n@NgModule({\r\n  declarations: [\r\n    BuyComponent\r\n  ],\r\n  imports: [\r\n    CommonModule,\r\n    BuyLazyRoutingModule,\r\n    MaterialModule,\r\n    ReactiveFormsModule,\r\n    FormsModule,\r\n    ProductFilterModule\r\n  ]\r\n})\r\nexport class BuyLazyModule { }\r\n"],"sourceRoot":"webpack:///"}