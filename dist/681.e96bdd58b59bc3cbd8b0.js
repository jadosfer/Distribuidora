(self.webpackChunke_commerce_mosh=self.webpackChunke_commerce_mosh||[]).push([[681],{16681:(e,t,n)=>{"use strict";n.r(t),n.d(t,{OrdersModule:()=>J});var r=n(61116),a=n(31041),l=n(87660),i=n(81830),d=n(66262),o=n(99484),s=n(90317),m=n(29996),p=n(20868),c=n(79270),u=n(23651),h=n(63995),g=n(3050),v=n(35366),f=n(42590),y=n(27455),x=n(87064),S=n(84369),E=n(54670),C=n(6489),I=n(13070),O=n(69024),b=n(47217);function w(e,t){if(1&e&&(v["\u0275\u0275elementStart"](0,"div",33),v["\u0275\u0275elementStart"](1,"div"),v["\u0275\u0275text"](2,"PEDIDOS RECIENTES SIN APROBAR: \xa0\xa0\xa0\xa0 "),v["\u0275\u0275element"](3,"span",34),v["\u0275\u0275text"](4,"\xa0\xa0\xa0\xa0 "),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"]()),2&e){const e=v["\u0275\u0275nextContext"](2);v["\u0275\u0275advance"](3),v["\u0275\u0275propertyInterpolate"]("matBadge",e.ordersNotAproved)}}function D(e,t){if(1&e){const e=v["\u0275\u0275getCurrentView"]();v["\u0275\u0275elementStart"](0,"tr"),v["\u0275\u0275elementStart"](1,"td"),v["\u0275\u0275text"](2),v["\u0275\u0275pipe"](3,"date"),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](4,"td"),v["\u0275\u0275elementStart"](5,"a",35),v["\u0275\u0275listener"]("click",function(){const t=v["\u0275\u0275restoreView"](e).$implicit;return v["\u0275\u0275nextContext"](2).toggleAccordion(t)}),v["\u0275\u0275text"](6),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](7,"td"),v["\u0275\u0275text"](8),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit;v["\u0275\u0275advance"](2),v["\u0275\u0275textInterpolate1"]("",v["\u0275\u0275pipeBind2"](3,3,e.date,"dd/MM/yyyy HH:mm"),"\xa0\xa0"),v["\u0275\u0275advance"](4),v["\u0275\u0275textInterpolate1"]("",e.fantasyName,"\xa0\xa0\xa0\xa0"),v["\u0275\u0275advance"](2),v["\u0275\u0275textInterpolate"](e.seller)}}function N(e,t){1&e&&(v["\u0275\u0275elementStart"](0,"mat-error"),v["\u0275\u0275text"](1,"Invalid start date"),v["\u0275\u0275elementEnd"]())}function V(e,t){1&e&&(v["\u0275\u0275elementStart"](0,"mat-error"),v["\u0275\u0275text"](1,"Invalid end date"),v["\u0275\u0275elementEnd"]())}function A(e,t){1&e&&(v["\u0275\u0275elementStart"](0,"th"),v["\u0275\u0275text"](1,"Fecha"),v["\u0275\u0275elementEnd"]())}function M(e,t){1&e&&(v["\u0275\u0275elementStart"](0,"th"),v["\u0275\u0275text"](1,"Monto c/IVA"),v["\u0275\u0275elementEnd"]())}function k(e,t){1&e&&(v["\u0275\u0275elementStart"](0,"th"),v["\u0275\u0275text"](1,"\xbfaprobado?"),v["\u0275\u0275elementEnd"]())}function q(e,t){1&e&&(v["\u0275\u0275elementStart"](0,"th"),v["\u0275\u0275text"](1,"IVA"),v["\u0275\u0275elementEnd"]())}function F(e,t){1&e&&(v["\u0275\u0275elementStart"](0,"th"),v["\u0275\u0275text"](1,"Pagado"),v["\u0275\u0275elementEnd"]())}function P(e,t){1&e&&(v["\u0275\u0275elementStart"](0,"th"),v["\u0275\u0275text"](1,"Desc?"),v["\u0275\u0275elementEnd"]())}function T(e,t){1&e&&(v["\u0275\u0275elementStart"](0,"th"),v["\u0275\u0275text"](1,"Deudor?"),v["\u0275\u0275elementEnd"]())}function U(e,t){if(1&e){const e=v["\u0275\u0275getCurrentView"]();v["\u0275\u0275elementStart"](0,"button",39),v["\u0275\u0275listener"]("click",function(){v["\u0275\u0275restoreView"](e);const t=v["\u0275\u0275nextContext"]().$implicit;return v["\u0275\u0275nextContext"](2).aprove(t)}),v["\u0275\u0275text"](1,"aprobar"),v["\u0275\u0275elementEnd"]()}if(2&e){const e=v["\u0275\u0275nextContext"]().$implicit;v["\u0275\u0275property"]("disabled",e.payload.val().aproved)}}function z(e,t){if(1&e&&(v["\u0275\u0275elementStart"](0,"tr"),v["\u0275\u0275elementStart"](1,"td"),v["\u0275\u0275text"](2),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](3,"td"),v["\u0275\u0275text"](4),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](5,"td"),v["\u0275\u0275text"](6),v["\u0275\u0275pipe"](7,"number"),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](8,"td"),v["\u0275\u0275text"](9),v["\u0275\u0275pipe"](10,"number"),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](11,"td"),v["\u0275\u0275text"](12),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;v["\u0275\u0275advance"](2),v["\u0275\u0275textInterpolate"](e.quantity),v["\u0275\u0275advance"](2),v["\u0275\u0275textInterpolate"](e.title),v["\u0275\u0275advance"](2),v["\u0275\u0275textInterpolate1"]("$",v["\u0275\u0275pipeBind2"](7,5,e.discountPrice,"1.1-1"),""),v["\u0275\u0275advance"](3),v["\u0275\u0275textInterpolate1"]("$",v["\u0275\u0275pipeBind2"](10,8,e.quantity*e.discountPrice,"1.1-1"),"\xa0\xa0"),v["\u0275\u0275advance"](3),v["\u0275\u0275textInterpolate"](e.discount?"%"+e.discount:"-")}}function L(e,t){if(1&e&&(v["\u0275\u0275elementStart"](0,"table",9),v["\u0275\u0275elementStart"](1,"tr"),v["\u0275\u0275elementStart"](2,"th"),v["\u0275\u0275text"](3,"Unid"),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](4,"th"),v["\u0275\u0275text"](5,"Producto"),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](6,"th"),v["\u0275\u0275text"](7,"Importe/unid"),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](8,"th"),v["\u0275\u0275text"](9,"Importe"),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](10,"th"),v["\u0275\u0275text"](11,"Desc"),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275template"](12,z,13,11,"tr",10),v["\u0275\u0275elementEnd"]()),2&e){const e=v["\u0275\u0275nextContext"](3);v["\u0275\u0275advance"](12),v["\u0275\u0275property"]("ngForOf",e.orderDetail.products)}}function R(e,t){if(1&e){const e=v["\u0275\u0275getCurrentView"]();v["\u0275\u0275elementStart"](0,"td"),v["\u0275\u0275elementStart"](1,"button",40),v["\u0275\u0275listener"]("click",function(){v["\u0275\u0275restoreView"](e);const t=v["\u0275\u0275nextContext"]().$implicit;return v["\u0275\u0275nextContext"](2).exportAsPDF(t)}),v["\u0275\u0275elementStart"](2,"mat-icon"),v["\u0275\u0275text"](3,"picture_as_pdf"),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"]()}if(2&e){const e=v["\u0275\u0275nextContext"]().$implicit;v["\u0275\u0275advance"](1),v["\u0275\u0275property"]("disabled",!e.payload.val().aproved)}}function B(e,t){if(1&e){const e=v["\u0275\u0275getCurrentView"]();v["\u0275\u0275elementStart"](0,"td"),v["\u0275\u0275elementStart"](1,"button",41),v["\u0275\u0275listener"]("click",function(){v["\u0275\u0275restoreView"](e);const t=v["\u0275\u0275nextContext"]().$implicit;return v["\u0275\u0275nextContext"](2).remove(t)}),v["\u0275\u0275elementStart"](2,"mat-icon"),v["\u0275\u0275text"](3,"delete"),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"]()}}function $(e,t){if(1&e){const e=v["\u0275\u0275getCurrentView"]();v["\u0275\u0275elementStart"](0,"tr"),v["\u0275\u0275elementStart"](1,"td"),v["\u0275\u0275text"](2),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](3,"td"),v["\u0275\u0275text"](4),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](5,"td"),v["\u0275\u0275text"](6),v["\u0275\u0275pipe"](7,"date"),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](8,"td"),v["\u0275\u0275text"](9),v["\u0275\u0275pipe"](10,"number"),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](11,"td"),v["\u0275\u0275text"](12),v["\u0275\u0275template"](13,U,2,1,"button",36),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](14,"td"),v["\u0275\u0275text"](15),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](16,"td"),v["\u0275\u0275text"](17),v["\u0275\u0275pipe"](18,"date"),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](19,"td"),v["\u0275\u0275text"](20),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](21,"td"),v["\u0275\u0275text"](22),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](23,"td"),v["\u0275\u0275elementStart"](24,"mat-accordion"),v["\u0275\u0275elementStart"](25,"mat-expansion-panel",37),v["\u0275\u0275listener"]("opened",function(){const t=v["\u0275\u0275restoreView"](e),n=t.$implicit,r=t.index;return v["\u0275\u0275nextContext"](2).expandOrderDetail(n,r)})("closed",function(){return v["\u0275\u0275restoreView"](e),v["\u0275\u0275nextContext"](2).isExpanded=!1}),v["\u0275\u0275elementStart"](26,"mat-expansion-panel-header"),v["\u0275\u0275elementStart"](27,"mat-panel-title"),v["\u0275\u0275text"](28," Detalle "),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275template"](29,L,13,1,"table",38),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275template"](30,R,4,1,"td",28),v["\u0275\u0275template"](31,B,4,0,"td",28),v["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,n=t.index,r=v["\u0275\u0275nextContext"](2);v["\u0275\u0275advance"](2),v["\u0275\u0275textInterpolate1"]("",e.payload.val().fantasyName,"\xa0\xa0"),v["\u0275\u0275advance"](2),v["\u0275\u0275textInterpolate1"]("",e.payload.val().seller,"\xa0\xa0"),v["\u0275\u0275advance"](2),v["\u0275\u0275textInterpolate1"]("",v["\u0275\u0275pipeBind2"](7,14,e.payload.val().date,"dd/MM/yyyy HH:mm"),"\xa0\xa0\xa0\xa0"),v["\u0275\u0275advance"](3),v["\u0275\u0275textInterpolate1"]("",v["\u0275\u0275pipeBind2"](10,17,e.payload.val().amountWithIva,"1.1-1"),"\xa0\xa0"),v["\u0275\u0275advance"](3),v["\u0275\u0275textInterpolate1"]("",e.payload.val().aproved?"SI":"NO","\xa0\xa0"),v["\u0275\u0275advance"](1),v["\u0275\u0275property"]("ngIf",null!=r.appUser&&r.appUser.isAdmin),v["\u0275\u0275advance"](2),v["\u0275\u0275textInterpolate1"]("%",e.payload.val().iva,"\xa0\xa0"),v["\u0275\u0275advance"](2),v["\u0275\u0275textInterpolate1"]("",e.payload.val().fullPaymentDate?v["\u0275\u0275pipeBind2"](18,20,e.payload.val().fullPaymentDate,"dd/MM/yyyy"):"NO","\xa0\xa0"),v["\u0275\u0275advance"](3),v["\u0275\u0275textInterpolate1"]("",e.payload.val().hasDiscount?"SI":"NO","\xa0\xa0"),v["\u0275\u0275advance"](2),v["\u0275\u0275textInterpolate1"]("",e.payload.val().clientInDebt?"SI":"NO","\xa0\xa0"),v["\u0275\u0275advance"](3),v["\u0275\u0275property"]("expanded",r.openAccordion===n),v["\u0275\u0275advance"](4),v["\u0275\u0275property"]("ngIf",r.orderDetail),v["\u0275\u0275advance"](1),v["\u0275\u0275property"]("ngIf",r.ordersService.clients),v["\u0275\u0275advance"](1),v["\u0275\u0275property"]("ngIf",r.appUser.isAdmin)}}function H(e,t){if(1&e){const e=v["\u0275\u0275getCurrentView"]();v["\u0275\u0275elementStart"](0,"button",42),v["\u0275\u0275listener"]("click",function(){v["\u0275\u0275restoreView"](e);const t=v["\u0275\u0275nextContext"](2);return t.downloadAll(t.currentItemsToShow)}),v["\u0275\u0275text"](1,"Descargar todos "),v["\u0275\u0275elementStart"](2,"mat-icon"),v["\u0275\u0275text"](3,"picture_as_pdf"),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"]()}}const _=function(){return[10,20]};function W(e,t){if(1&e){const e=v["\u0275\u0275getCurrentView"]();v["\u0275\u0275elementStart"](0,"mat-paginator",43),v["\u0275\u0275listener"]("page",function(t){return v["\u0275\u0275restoreView"](e),v["\u0275\u0275nextContext"](2).onPageChange(t)}),v["\u0275\u0275elementEnd"]()}if(2&e){const e=v["\u0275\u0275nextContext"](2);v["\u0275\u0275property"]("length",e.filteredOrders.length)("pageSize",10)("pageSizeOptions",v["\u0275\u0275pureFunction0"](3,_))}}function G(e,t){if(1&e){const e=v["\u0275\u0275getCurrentView"]();v["\u0275\u0275elementStart"](0,"div",2),v["\u0275\u0275elementStart"](1,"div",3),v["\u0275\u0275elementStart"](2,"div",4),v["\u0275\u0275elementStart"](3,"h1"),v["\u0275\u0275text"](4,"PEDIDOS"),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](5,"div",5),v["\u0275\u0275elementStart"](6,"a",6),v["\u0275\u0275elementStart"](7,"mat-icon"),v["\u0275\u0275text"](8,"control_point"),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](9,"span"),v["\u0275\u0275text"](10,"Crear Pedido"),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275template"](11,w,5,1,"div",7),v["\u0275\u0275elementStart"](12,"div",3),v["\u0275\u0275elementStart"](13,"mat-accordion"),v["\u0275\u0275elementStart"](14,"mat-expansion-panel",8),v["\u0275\u0275elementStart"](15,"mat-expansion-panel-header"),v["\u0275\u0275elementStart"](16,"mat-panel-title"),v["\u0275\u0275text"](17," Detalle "),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](18,"table",9),v["\u0275\u0275elementStart"](19,"thead"),v["\u0275\u0275elementStart"](20,"tr"),v["\u0275\u0275elementStart"](21,"th"),v["\u0275\u0275text"](22,"Fecha"),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](23,"th"),v["\u0275\u0275text"](24,"Cliente"),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](25,"th"),v["\u0275\u0275text"](26,"Vendedor"),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](27,"tbody"),v["\u0275\u0275template"](28,D,9,6,"tr",10),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275element"](29,"hr"),v["\u0275\u0275elementStart"](30,"div",3),v["\u0275\u0275elementStart"](31,"div",3),v["\u0275\u0275elementStart"](32,"div",5),v["\u0275\u0275elementStart"](33,"div",11),v["\u0275\u0275elementStart"](34,"div"),v["\u0275\u0275elementStart"](35,"mat-icon",12),v["\u0275\u0275text"](36,"search"),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](37,"input",13,14),v["\u0275\u0275listener"]("ngModelChange",function(t){return v["\u0275\u0275restoreView"](e),v["\u0275\u0275nextContext"]().clientValue=t})("ngModelChange",function(){v["\u0275\u0275restoreView"](e);const t=v["\u0275\u0275reference"](38);return v["\u0275\u0275nextContext"]().filter(t.value)})("keyup",function(){v["\u0275\u0275restoreView"](e);const t=v["\u0275\u0275reference"](38);return v["\u0275\u0275nextContext"]().filter(t.value)}),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](39,"div",5),v["\u0275\u0275elementStart"](40,"div",11),v["\u0275\u0275elementStart"](41,"div"),v["\u0275\u0275elementStart"](42,"mat-icon",12),v["\u0275\u0275text"](43,"search"),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](44,"input",15,16),v["\u0275\u0275listener"]("ngModelChange",function(t){return v["\u0275\u0275restoreView"](e),v["\u0275\u0275nextContext"]().sellerValue=t})("keyup",function(){v["\u0275\u0275restoreView"](e);const t=v["\u0275\u0275reference"](45);return v["\u0275\u0275nextContext"]().filterBySeller(t.value)}),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](46,"div",5),v["\u0275\u0275elementStart"](47,"div",11),v["\u0275\u0275elementStart"](48,"div"),v["\u0275\u0275elementStart"](49,"mat-icon",12),v["\u0275\u0275text"](50,"search"),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](51,"input",17,18),v["\u0275\u0275listener"]("ngModelChange",function(t){return v["\u0275\u0275restoreView"](e),v["\u0275\u0275nextContext"]().dateValue=t})("keyup",function(){v["\u0275\u0275restoreView"](e);const t=v["\u0275\u0275reference"](52);return v["\u0275\u0275nextContext"]().filterByDate(t.value)}),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](53,"div",19),v["\u0275\u0275elementStart"](54,"form",20,21),v["\u0275\u0275listener"]("ngSubmit",function(){v["\u0275\u0275restoreView"](e);const t=v["\u0275\u0275nextContext"]();return t.searchDateRange(t.range.value)}),v["\u0275\u0275elementStart"](56,"mat-form-field",22),v["\u0275\u0275elementStart"](57,"mat-label"),v["\u0275\u0275text"](58,"Ingrese un rango de fechas"),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](59,"mat-date-range-input",23),v["\u0275\u0275element"](60,"input",24),v["\u0275\u0275element"](61,"input",25),v["\u0275\u0275elementEnd"](),v["\u0275\u0275element"](62,"mat-datepicker-toggle",26),v["\u0275\u0275element"](63,"mat-date-range-picker",null,27),v["\u0275\u0275template"](65,N,2,0,"mat-error",28),v["\u0275\u0275template"](66,V,2,0,"mat-error",28),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](67,"button",29),v["\u0275\u0275text"](68,"buscar por rango"),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](69,"button",30,14),v["\u0275\u0275listener"]("click",function(){return v["\u0275\u0275restoreView"](e),v["\u0275\u0275nextContext"]().clearRange()}),v["\u0275\u0275text"](71,"borrar b\xfasqueda"),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](72,"table",9),v["\u0275\u0275elementStart"](73,"thead"),v["\u0275\u0275elementStart"](74,"tr"),v["\u0275\u0275elementStart"](75,"th"),v["\u0275\u0275text"](76,"Cliente"),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](77,"th"),v["\u0275\u0275text"](78,"Vendedor"),v["\u0275\u0275elementEnd"](),v["\u0275\u0275template"](79,A,2,0,"th",28),v["\u0275\u0275template"](80,M,2,0,"th",28),v["\u0275\u0275template"](81,k,2,0,"th",28),v["\u0275\u0275template"](82,q,2,0,"th",28),v["\u0275\u0275template"](83,F,2,0,"th",28),v["\u0275\u0275template"](84,P,2,0,"th",28),v["\u0275\u0275template"](85,T,2,0,"th",28),v["\u0275\u0275elementStart"](86,"th"),v["\u0275\u0275text"](87,"Detalle"),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](88,"tbody"),v["\u0275\u0275template"](89,$,32,23,"tr",10),v["\u0275\u0275elementStart"](90,"tr"),v["\u0275\u0275elementStart"](91,"th"),v["\u0275\u0275text"](92,"TOTAL"),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](93,"th"),v["\u0275\u0275text"](94),v["\u0275\u0275pipe"](95,"number"),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275template"](96,H,4,0,"button",31),v["\u0275\u0275template"](97,W,1,4,"mat-paginator",32),v["\u0275\u0275elementEnd"]()}if(2&e){const e=v["\u0275\u0275reference"](64),t=v["\u0275\u0275nextContext"]();v["\u0275\u0275advance"](11),v["\u0275\u0275property"]("ngIf",t.ordersNotAproved>0),v["\u0275\u0275advance"](17),v["\u0275\u0275property"]("ngForOf",t.notAprovedOrders),v["\u0275\u0275advance"](9),v["\u0275\u0275property"]("ngModel",t.clientValue),v["\u0275\u0275advance"](7),v["\u0275\u0275property"]("ngModel",t.sellerValue),v["\u0275\u0275advance"](7),v["\u0275\u0275property"]("ngModel",t.dateValue),v["\u0275\u0275advance"](8),v["\u0275\u0275property"]("formGroup",t.range)("rangePicker",e),v["\u0275\u0275advance"](3),v["\u0275\u0275property"]("for",e),v["\u0275\u0275advance"](3),v["\u0275\u0275property"]("ngIf",t.range.controls.start.hasError("matStartDateInvalid")),v["\u0275\u0275advance"](1),v["\u0275\u0275property"]("ngIf",t.range.controls.end.hasError("matEndDateInvalid")),v["\u0275\u0275advance"](13),v["\u0275\u0275property"]("ngIf",!t.isExpanded),v["\u0275\u0275advance"](1),v["\u0275\u0275property"]("ngIf",!t.isExpanded),v["\u0275\u0275advance"](1),v["\u0275\u0275property"]("ngIf",!t.isExpanded),v["\u0275\u0275advance"](1),v["\u0275\u0275property"]("ngIf",!t.isExpanded),v["\u0275\u0275advance"](1),v["\u0275\u0275property"]("ngIf",!t.isExpanded),v["\u0275\u0275advance"](1),v["\u0275\u0275property"]("ngIf",!t.isExpanded),v["\u0275\u0275advance"](1),v["\u0275\u0275property"]("ngIf",!t.isExpanded),v["\u0275\u0275advance"](4),v["\u0275\u0275property"]("ngForOf",t.currentItemsToShow),v["\u0275\u0275advance"](5),v["\u0275\u0275textInterpolate1"]("$",v["\u0275\u0275pipeBind2"](95,21,t.getTotal(),"1.1-1"),""),v["\u0275\u0275advance"](2),v["\u0275\u0275property"]("ngIf",t.currentItemsToShow),v["\u0275\u0275advance"](1),v["\u0275\u0275property"]("ngIf",t.filteredOrders)}}function j(e,t){if(1&e&&(v["\u0275\u0275elementStart"](0,"tr"),v["\u0275\u0275elementStart"](1,"td"),v["\u0275\u0275text"](2),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](3,"td"),v["\u0275\u0275text"](4),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](5,"td",46),v["\u0275\u0275text"](6),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;v["\u0275\u0275advance"](2),v["\u0275\u0275textInterpolate"](e.debtorName),v["\u0275\u0275advance"](2),v["\u0275\u0275textInterpolate"](e.orderDate),v["\u0275\u0275advance"](2),v["\u0275\u0275textInterpolate"](e.orderDebt)}}function K(e,t){if(1&e){const e=v["\u0275\u0275getCurrentView"]();v["\u0275\u0275elementStart"](0,"div",44),v["\u0275\u0275elementStart"](1,"h2"),v["\u0275\u0275text"](2,"Estimado vendedor: los siguientes clientes tienen deuda. Por favor regularice la situaci\xf3n."),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](3,"table",9),v["\u0275\u0275elementStart"](4,"tr"),v["\u0275\u0275elementStart"](5,"th"),v["\u0275\u0275text"](6,"Cliente"),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](7,"th"),v["\u0275\u0275text"](8,"Fecha del pedido en deuda"),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](9,"th"),v["\u0275\u0275text"](10,"Monto del pedido"),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"](),v["\u0275\u0275template"](11,j,7,3,"tr",10),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementStart"](12,"button",45),v["\u0275\u0275listener"]("click",function(){v["\u0275\u0275restoreView"](e);const t=v["\u0275\u0275nextContext"]();return t.debtWarning=!t.debtWarning}),v["\u0275\u0275text"](13,"Aceptar"),v["\u0275\u0275elementEnd"](),v["\u0275\u0275elementEnd"]()}if(2&e){const e=v["\u0275\u0275nextContext"]();v["\u0275\u0275advance"](11),v["\u0275\u0275property"]("ngForOf",e.debtors)}}const Y=[{path:"",component:(()=>{class e{constructor(e,t,n,r,l){this.ordersService=e,this.auth=t,this.datepipe=n,this.stockService=r,this.dateAdapter=l,this.range=new a.FormGroup({start:new a.FormControl,end:new a.FormControl}),this.recentUserOrders=[],this.userOrders=[],this.ordersNotAproved=0,this.notAprovedOrders=[],this.query={client:"",seller:"",date:"",dateRange:{start:new Date(2017,1,1),end:new Date(2040,1,1)}},this.isExpanded=!1,this.debtWarning=!1,this.openAccordion=-1,this.dateAdapter.setLocale("en-GB")}ngOnInit(){this.orders=this.ordersService.orders,this.subscription=this.auth.appUser$.subscribe(e=>{this.appUser=e,this.ordersService.getAllOrders().subscribe(e=>{this.orders=e,this.userClients=this.ordersService.getUserClients(this.appUser.name),this.recentUserOrders=[],this.userOrders=[],this.debtors=[],this.dateRangefilteredOrders=[],this.currentItemsToShow=[],this.notAprovedOrders=[],this.ordersNotAproved=0;for(let l=0;l<this.orders.length;l++){let e=this.orders[l].payload.val().seller==this.appUser.name,t=this.isClientInUserClients(this.orders[l].payload.val().fantasyName,this.userClients),n=Date.now()-this.orders[l].payload.val().date<24*g.g*60*60*1e3;this.appUser&&(this.appUser.isAdmin||this.appUser.isSalesManager||e||t)&&(this.userOrders.push(this.orders[l]),0==this.orders[l].payload.val().aproved&&(this.notAprovedOrders.push(this.orders[l].payload.val()),this.ordersNotAproved+=1)),this.appUser&&(this.appUser.isAdmin||this.appUser.isSalesManager||e||t)&&n&&this.recentUserOrders.push(this.orders[l])}for(let l=0;l<this.recentUserOrders.length;l++)if(this.ordersService.isClientInDebt(this.recentUserOrders[l].payload.val().fantasyName,this.recentUserOrders)){this.debtors=[];let e=new Date(this.recentUserOrders[l].payload.val().date);this.debtors.push({debtorName:this.recentUserOrders[l].payload.val().fantasyName,orderDate:e.getDate()+"/"+e.getMonth()+"/"+e.getFullYear(),orderDebt:this.recentUserOrders[l].payload.val().amountWithIva}),this.debtWarning=!0}this.dateRangefilteredOrders=this.datefilteredOrders=this.filteredOrders=this.recentUserOrders,this.currentItemsToShow=this.filteredOrders;let t=(new Date).getDate().toString(),n=(new Date).getMonth()+1,r=(new Date).getFullYear(),a=n.toString();n<10&&(a="0"+n.toString()),this.dateValue=t+"/"+a+"/"+r,this.filterByDate(this.dateValue),this.onPageChange({previousPageIndex:0,pageIndex:0,pageSize:10,length:this.filteredOrders.length}),this.ordersService.fantasyName&&(this.dateValue="",this.clientValue=this.ordersService.fantasyName,this.filter(this.ordersService.fantasyName),this.ordersService.fantasyName="",this.filterByDate(""))})})}expandOrderDetail(e,t){this.openAccordion=this.openAccordion===t?-1:t,this.orderDetail=this.ordersService.getOrderDetail(e.payload.val().orderDetailKey).payload.val(),console.log("this.orderDetail",this.orderDetail)}filter(e){var t;this.query.client=e,this.filteredOrders=[];for(let n=0;n<this.userOrders.length;n++)this.userOrders[n].payload.val().fantasyName.toLowerCase().includes(e.toLowerCase())&&this.userOrders[n].payload.val().seller.toLowerCase().includes(this.query.seller.toLowerCase())&&(null===(t=this.datepipe.transform(this.userOrders[n].payload.val().date,"dd/MM/yyyy HH:mm"))||void 0===t?void 0:t.includes(this.query.date))&&this.filteredOrders.push(this.userOrders[n]);this.filteredOrders.filter(e=>e.payload.val().date>this.query.dateRange.start.getTime()&&e.payload.val().date<this.query.dateRange.start.getTime()),this.onPageChange({previousPageIndex:0,pageIndex:0,pageSize:10,length:this.filteredOrders.length}),this.paginator&&(this.paginator.pageIndex=0)}filterBySeller(e){var t;this.query.seller=e,this.filteredOrders=[];for(let n=0;n<this.userOrders.length;n++)this.userOrders[n].payload.val().fantasyName.toLowerCase().includes(this.query.client.toLowerCase())&&this.userOrders[n].payload.val().seller.toLowerCase().includes(e.toLowerCase())&&(null===(t=this.datepipe.transform(this.userOrders[n].payload.val().date,"dd/MM/yyyy HH:mm"))||void 0===t?void 0:t.includes(this.query.date))&&this.filteredOrders.push(this.userOrders[n]);this.filteredOrders.filter(e=>e.payload.val().date>this.query.dateRange.start.getTime()&&e.payload.val().date<this.query.dateRange.start.getTime()),this.onPageChange({previousPageIndex:0,pageIndex:0,pageSize:10,length:this.filteredOrders.length}),this.paginator&&(this.paginator.pageIndex=0)}filterByDate(e){var t;this.query.date=e,this.filteredOrders=[];for(let n=0;n<this.userOrders.length;n++)this.userOrders[n].payload.val().fantasyName.toLowerCase().includes(this.query.client.toLowerCase())&&this.userOrders[n].payload.val().seller.toLowerCase().includes(this.query.seller.toLowerCase())&&(null===(t=this.datepipe.transform(this.userOrders[n].payload.val().date,"dd/MM/yyyy HH:mm"))||void 0===t?void 0:t.includes(e))&&this.filteredOrders.push(this.userOrders[n]);this.filteredOrders.filter(e=>e.payload.val().date>this.query.dateRange.start.getTime()&&e.payload.val().date<this.query.dateRange.start.getTime()),this.onPageChange({previousPageIndex:0,pageIndex:0,pageSize:10,length:this.filteredOrders.length}),this.paginator&&(this.paginator.pageIndex=0)}searchDateRange(e){var t,n,r;if(e.start){this.filteredOrders=[];for(let e=0;e<this.userOrders.length;e++)this.userOrders[e].payload.val().fantasyName.toLowerCase().includes(this.query.client.toLowerCase())&&this.userOrders[e].payload.val().seller.toLowerCase().includes(this.query.seller.toLowerCase())&&(null===(t=this.datepipe.transform(this.userOrders[e].payload.val().date,"dd/MM/yyyy HH:mm"))||void 0===t?void 0:t.includes(this.query.date))&&this.filteredOrders.push(this.userOrders[e]);this.filteredOrders=e?this.filteredOrders.filter(t=>t.payload.val().date>Date.parse(e.start._d)&&t.payload.val().date<Date.parse(e.end._d)):this.filteredOrders,this.query.dateRange.start=new Date(Date.parse(null===(n=e.start)||void 0===n?void 0:n._d)),this.query.dateRange.end=new Date(Date.parse(null===(r=e.end)||void 0===r?void 0:r._d))}this.onPageChange({previousPageIndex:0,pageIndex:0,pageSize:10,length:this.filteredOrders.length}),this.paginator&&(this.paginator.pageIndex=0)}onPageChange(e){this.currentItemsToShow=this.filteredOrders.slice(e.pageIndex*e.pageSize,e.pageIndex*e.pageSize+e.pageSize)}getTitle(e){return e.title}compare(e,t,n){return(e<t?-1:1)*(n?1:-1)}getTotal(){let e=0;return this.filteredOrders&&this.filteredOrders.forEach(t=>{e+=parseFloat(t.payload.val().amountWithIva)}),e}aprove(e){if(confirm("Est\xe1 segur@ que quiere aprobar el pedido para que pueda ser entregada la mercader\xeda?")){if(e.payload.val().clientInDebt&&!this.appUser.isOwner)return;this.stockService.aprove(e),this.ordersService.aproveOrder(e)}}clearRange(){this.range.setValue({start:null,end:null}),this.sellerValue="",this.clientValue="",this.dateValue="",this.filterByDate(this.dateValue),this.onPageChange({previousPageIndex:0,pageIndex:0,pageSize:10,length:this.filteredOrders.length}),this.paginator&&(this.paginator.pageIndex=0)}isOrderInDebt(e){return this.ordersService.isOrderInDebt(e)}toggleAccordion(e){this.dateValue="",this.query.client="",this.query.date="";let t=this.userOrders.filter(t=>t.payload.val().date==e.date);this.currentItemsToShow=t,window.scrollBy({top:window.innerHeight,behavior:"smooth"})}exportAsPDF(e){let t=this.ordersService.getOrderDetail(e.payload.val().orderDetailKey).payload.val().products,n=new Date(e.payload.val().date),r=String(n.getDate()).padStart(2,"0")+"/"+String(n.getMonth()+1).padStart(2,"0")+"/"+n.getFullYear();const a=50;let l=this.ordersService.getAddress(e.payload.val().fantasyName);var i=new u.kH;i.setFontSize(10),i.text("GENTECH MAR DEL PLATA",10,20),i.text("FECHA DEL PEDIDO: "+r,70,20),i.text("FACT N\xba: "+e.payload.val().orderNumber,140,20),i.setFontSize(7),i.text("CLIENTE: "+e.payload.val().fantasyName,10,30),i.text("VENDEDOR: "+e.payload.val().seller,70,30),i.text("DIRECCI\xd3N: "+l,140,30),i.setFontSize(10),i.text("---------------------------------------------------------------------------------------------------------------------------------------------------------------------",10,35),i.text("Cantidad",10,40),i.text("Producto",30,40);let d=0;"Gimnasio"!=this.ordersService.getClientCategory(e.payload.val().fantasyName)&&"Kiosko"!=this.ordersService.getClientCategory(e.payload.val().fantasyName)?i.text("Importe+iva",185,40):d=30,i.text("Importe/uni",125+d,40),i.text("Importe",155+d,40);let o=0;for(let m=0;m<t.length;m++)if(0!=t[m].quantity){let n=t[m].discountPrice*t[m].quantity;i.text(t[m].quantity.toString(),10,a+10*o),i.text(t[m].title,30,a+10*o),d=0,"Gimnasio"!=this.ordersService.getClientCategory(e.payload.val().fantasyName)&&"Kiosko"!=this.ordersService.getClientCategory(e.payload.val().fantasyName)?i.text("$"+(n*(1+e.payload.val().iva/100)).toFixed(1),185,a+10*o):d=30,i.text("$"+t[m].discountPrice.toFixed(1),125+d,a+10*o),i.text("$"+n.toFixed(1),155+d,a+10*o),o+=1}let s=a+10*o+10;i.text("---------------------------------------------------------------------------------------------------------------------------------------------------------------------",10,s-5),"Gimnasio"!=this.ordersService.getClientCategory(e.payload.val().fantasyName)&&"Kiosko"!=this.ordersService.getClientCategory(e.payload.val().fantasyName)?i.text("TOTAL CON IVA "+e.payload.val().iva+"%       $"+(this.ordersService.getTotalAmount(t)*(1+e.payload.val().iva/100)).toFixed(1),10,s):i.text("TOTAL $"+(this.ordersService.getTotalAmount(t)*(1+e.payload.val().iva/100)).toFixed(1),10,s),i.save(`${e.payload.val().fantasyName} ${r}.pdf`)}remove(e){confirm("Est\xe1 segur@ que quiere eliminar este pedido? Se restar\xe1 el monto del pedido a la deuda del cliente")&&this.ordersService.removeOrder(e)}isClientInUserClients(e,t){for(let n=0;n<t.length;n++)if(e.toLowerCase().includes(t[n].toLowerCase()))return!0;return!1}downloadAll(e){e.forEach(e=>{this.exportAsPDF(e)})}ngOnDestroy(){this.subscription.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(v["\u0275\u0275directiveInject"](s.N),v["\u0275\u0275directiveInject"](f.e),v["\u0275\u0275directiveInject"](r.uU),v["\u0275\u0275directiveInject"](y.q),v["\u0275\u0275directiveInject"](x._A))},e.\u0275cmp=v["\u0275\u0275defineComponent"]({type:e,selectors:[["orders"]],viewQuery:function(e,t){if(1&e&&v["\u0275\u0275viewQuery"](h.NW,5),2&e){let e;v["\u0275\u0275queryRefresh"](e=v["\u0275\u0275loadQuery"]())&&(t.paginator=e.first)}},decls:3,vars:2,consts:[["class","SCContainer ms-1",4,"ngIf","ngIfElse"],["elseBlock",""],[1,"SCContainer","ms-1"],[1,"row"],[1,"col-6","col-md-4","my-2"],[1,"col-6","col-md-4","my-1"],["mat-icon-button","","routerLink","/orders/order"],["class","col my-2",4,"ngIf"],["hideToggle",""],[1,"table","table-striped","table-sm","mat-elevation-z8"],[4,"ngFor","ngForOf"],[1,"input-group"],["matSuffix",""],["type","text","placeholder","   Nombre de Fantas\xeda...",1,"border-end-0","border","rounded-pill",3,"ngModel","ngModelChange","keyup"],["query",""],["type","text","placeholder","   Vendedor...",1,"border-end-0","border","rounded-pill",3,"ngModel","ngModelChange","keyup"],["sellerquery",""],["type","text","placeholder","   Fecha...",1,"border-end-0","border","rounded-pill",3,"ngModel","ngModelChange","keyup"],["Datequery",""],[1,"row","m-3"],[3,"ngSubmit"],["f","ngForm"],["appearance","fill"],[3,"formGroup","rangePicker"],["matStartDate","","formControlName","start","placeholder","fecha inicio"],["matEndDate","","formControlName","end","placeholder","fecha finalizaci\xf3n"],["matSuffix","",3,"for"],["picker",""],[4,"ngIf"],["mat-raised-button","","type","submit","color","primary"],["mat-raised-button","","color","accent",3,"click"],["mat-raised-button","","color","primary",3,"click",4,"ngIf"],[3,"length","pageSize","pageSizeOptions","page",4,"ngIf"],[1,"col","my-2"],["matBadgeSize","large",3,"matBadge"],["routerLink","/orders/orders",3,"click"],[3,"disabled","click",4,"ngIf"],["hideToggle","",3,"expanded","opened","closed"],["class","table table-striped table-sm mat-elevation-z8",4,"ngIf"],[3,"disabled","click"],["mat-icon-button","","color","primary",3,"disabled","click"],["mat-icon-button","","color","accent",3,"click"],["mat-raised-button","","color","primary",3,"click"],[3,"length","pageSize","pageSizeOptions","page"],[1,"SCContainer"],["mat-raised-button","","color","primary",2,"margin","20px",3,"click"],[1,"text-danger"]],template:function(e,t){if(1&e&&(v["\u0275\u0275template"](0,G,98,24,"div",0),v["\u0275\u0275template"](1,K,14,1,"ng-template",null,1,v["\u0275\u0275templateRefExtractor"])),2&e){const e=v["\u0275\u0275reference"](2);v["\u0275\u0275property"]("ngIf",t.appUser&&(!t.debtWarning||t.appUser.isAdmin))("ngIfElse",e)}},directives:[r.O5,S.zs,m.yS,E.Hw,C.pp,C.ib,C.yz,C.yK,r.sg,I.R9,a.DefaultValueAccessor,a.NgControlStatus,a.NgModel,a["\u0275NgNoValidate"],a.NgControlStatusGroup,a.NgForm,I.KE,I.hX,O.wx,a.FormGroupDirective,O.zY,a.FormControlName,O.By,O.nW,O._g,S.lW,b.k,I.TO,h.NW],pipes:[r.JJ,r.uU],styles:["td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{text-align:left;border-bottom:1px solid #ddd}table[_ngcontent-%COMP%]{border:1px solid #000;border-radius:1%}"]}),e})(),canActivate:[p.a,c.O]}];let Q=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=v["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=v["\u0275\u0275defineInjector"]({imports:[[m.Bz.forChild(Y)],m.Bz]}),e})(),J=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=v["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=v["\u0275\u0275defineInjector"]({providers:[i.H,d.t,s.N],imports:[[r.ez,Q,a.FormsModule,l.q,a.ReactiveFormsModule,o.t]]}),e})()}}]);